# 銀行財報自動化抓取與分析系統

## 專案簡介

本專案是一個自動化工具，用於從台灣各大銀行官方網站抓取財務報表，並從中提取「資產品質」相關資料，最終彙整成 Excel 報表。支援 38 家台灣銀行的財報處理。

## 功能特色

### 1. 財報自動下載
- 自動從各銀行官網抓取指定年度/季度的財務報表
- 支援單一銀行或批次下載全部銀行
- 多線程並行下載，提升效率（最多 20 個工作線程）
- 自動檢測已下載檔案，避免重複下載

### 2. 資產品質報表製作
- 自動解析 PDF 財報，提取「資產品質」表格資料
- 支援多種 PDF 格式解析（文字型與圖片型）
- 將資料彙整輸出為 Excel 格式

## 環境需求

### Python 版本
- Python 3.8 以上

### 必要套件
```bash
pip install -r requirements.txt
```

或手動安裝：
```bash
# 網頁爬蟲相關
pip install requests beautifulsoup4 html5lib selenium

# 資料處理
pip install pandas numpy openpyxl

# PDF 處理
pip install pdfplumber tabula-py PyMuPDF

# 圖像處理與 OCR
pip install opencv-python pytesseract
```

### 其他需求
- **Microsoft Edge 瀏覽器**：用於 Selenium 網頁自動化
- **Edge WebDriver**：需與 Edge 瀏覽器版本相符
- **Tesseract OCR**：用於圖片文字辨識（部分銀行財報需要）
  ```bash
  # Ubuntu/Debian
  sudo apt install tesseract-ocr tesseract-ocr-chi-tra
  
  # macOS
  brew install tesseract tesseract-lang
  ```

## 檔案結構

```
bank/
├── Main.py              # 主程式入口
├── get_Data.py          # 財報下載模組
├── gat_report.py        # 報表製作模組
├── bank.xlsx            # 銀行清單與相關設定
├── README.md            # 專案說明文件
├── content.md           # 程式內容介紹
├── data/                # 下載的財報存放目錄
│   └── {年度}Q{季度}/   # 依年度季度分類
│       └── *.pdf        # 各銀行財報 PDF
└── Output/              # 輸出報表存放目錄
    └── {年度}Q{季度}/   # 依年度季度分類
        └── *.xlsx       # 彙整的資產品質報表
```

## 使用方式

### 執行主程式
```bash
python Main.py
```

### 操作選單

程式啟動後會顯示選單：

```
欲下載財報請輸入 1, 欲製作報表請輸入 2：
```

#### 模式一：下載財報 (輸入 1)

1. 輸入欲下載的季度，格式為 `年度Q季度`（例如：`114Q1` 表示民國 114 年第一季）
2. 選擇下載方式：
   - 輸入 `1`：下載單一銀行財報
   - 輸入 `ALL`：下載全部 38 家銀行財報

##### 單一銀行下載
```
請輸入欲查詢資產狀況之銀行簡稱 (ex:台企)：
```
輸入銀行簡稱後，系統會自動下載該銀行的財報。

##### 全部銀行下載
系統會自動下載所有銀行的財報，完成後會列出下載失敗的銀行清單。

#### 模式二：製作報表 (輸入 2)

1. 輸入欲製作報表的季度（例如：`112Q1`）
2. 系統會自動解析 `data/` 資料夾中對應季度的 PDF 檔案
3. 提取「資產品質」資料並輸出至 `Output/` 資料夾

## 資料說明

### 輸入資料
- **bank.xlsx**：銀行清單，包含：
  - 序號
  - 銀行代碼
  - 銀行名稱
  - 銀行官網連結

### 輸出資料
提取的資產品質資料包含以下項目：

| 項目 | 說明 |
|------|------|
| 企業金融_擔保 | 企業金融擔保放款 |
| 企業金融_無擔保 | 企業金融無擔保放款 |
| 消費金融_住宅抵押貸款 | 住宅抵押貸款 |
| 消費金融_現金卡 | 現金卡業務 |
| 消費金融_小額純信用貸款 | 小額純信用貸款 |
| 消費金融_其他_擔保 | 其他消費金融擔保放款 |
| 消費金融_其他_無擔保 | 其他消費金融無擔保放款 |
| 合計 | 以上項目合計 |

## 支援的銀行清單

本系統支援以下 38 家銀行：

1. 臺灣銀行
2. 臺灣土地銀行
3. 合作金庫商業銀行
4. 第一商業銀行
5. 華南商業銀行
6. 彰化商業銀行
7. 上海商業儲蓄銀行
8. 台北富邦銀行
9. 國泰世華商業銀行
10. ...（詳見 bank.xlsx）

## 設定說明

### Proxy 設定

如需透過代理伺服器存取銀行網站，請修改 `get_Data.py` 中的 Proxy 設定：

```python
proxy = "XX.XX.X.XX:XXXX"  # 修改為您的 Proxy IP 與 Port
proxies = {
    "http": "http://" + proxy,
    "https": "http://" + proxy,
}
```

## 常見問題

### Q1: 下載失敗怎麼辦？
- 確認網路連線正常
- 確認 Proxy 設定正確
- 確認該銀行是否已公布該季度財報
- 銀行網站可能已更新結構，需要更新爬蟲程式

### Q2: PDF 解析失敗？
- 部分銀行的 PDF 為掃描圖片格式，需要 OCR 處理
- 確認已安裝 Tesseract OCR 及繁體中文語言包
- 檢查 PDF 檔案是否完整下載

### Q3: WebDriver 錯誤？
- 確認已安裝 Microsoft Edge 瀏覽器
- 下載對應版本的 Edge WebDriver
- 將 WebDriver 加入系統 PATH

## 注意事項

1. 本程式僅供學術研究與內部使用
2. 請遵守各銀行網站的使用條款
3. 避免過於頻繁的請求，以免造成網站負擔
4. 財報資料以各銀行官網公布為準

## 更新日誌

- **v1.0**：初始版本，支援 38 家銀行財報下載與資產品質報表製作

## 授權資訊

本專案僅供內部使用，未經授權請勿散布。
