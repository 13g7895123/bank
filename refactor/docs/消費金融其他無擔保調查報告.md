# 消費金融_其他_無擔保類別調查報告

> 調查日期：2025-11-29  
> 調查目標：確認缺少「消費金融_其他_無擔保」類別的銀行 PDF 原始資料狀況

---

## 調查結論摘要

| 類型 | 銀行數量 | 說明 |
|------|----------|------|
| 🔴 **解析器識別問題** | 6 家 | PDF 中有完整資料，但解析器因格式差異未能識別 |

---

## 缺少此類別的銀行

根據報表解析測試報告，以下銀行缺少 `07_消費金融_其他_無擔保` 類別：

| 代碼 | 銀行名稱 | 季度 | 同時缺少的其他類別 |
|------|----------|------|------------------|
| 08 | 台北富邦銀行 | 114Q1 | 企業金融_擔保、企業金融_無擔保、現金卡 |
| 15 | 王道商業銀行 | 114Q1 | 企業金融_擔保、企業金融_無擔保、現金卡 |
| 27 | 聯邦商業銀行 | 114Q1 | 企業金融_擔保、企業金融_無擔保 |
| 31 | 玉山商業銀行 | 114Q1 | 企業金融_擔保、企業金融_無擔保、現金卡 |
| 34 | 台新國際商業銀行 | 114Q1 | 企業金融_擔保、企業金融_無擔保、現金卡 |
| 10 | 中國輸出入銀行 | 114Q1 | 所有消費金融類別（無此業務） |

---

## 詳細調查結果

### 08 台北富邦銀行 (114Q1) - 有資料

**資產品質頁：第 7 頁**

```
表格行 7: [None, '其他\n（註六）', '擔 保', '789,113', '553,084,761', '0.14%', '5,747,186', '728.31%']
表格行 8: [None, None, '無 擔 保', '69,463', '39,476,849', '0.18%', '416,481', '599.57%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 消費金融_其他_擔保 | 789,113 | 553,084,761 | 0.14% |
| **消費金融_其他_無擔保** | **69,463** | **39,476,849** | **0.18%** |

✅ **PDF 有完整資料，解析器未能識別**

---

### 15 王道商業銀行 (114Q1) - 有資料

**資產品質頁：第 5 頁**

```
表格行 7: [None, '其 他\n（註六）', '擔 保', '6,967', '8,057,166', '0.09%', '81,625', '1,171.59%']
表格行 8: [None, None, '無 擔 保', '65,030', '19,003,994', '0.34%', '333,444', '512.75%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 消費金融_其他_擔保 | 6,967 | 8,057,166 | 0.09% |
| **消費金融_其他_無擔保** | **65,030** | **19,003,994** | **0.34%** |

✅ **PDF 有完整資料，解析器未能識別**

---

### 27 聯邦商業銀行 (114Q1) - 有資料

**資產品質頁：第 11 頁**

```
表格行 7: [None, '其 他\n（註六）', '擔 保', '247,086', '83,835,636', '0.29%', '1,096,810', '329.73%']
表格行 8: [None, None, '無 擔 保', '85,549', '23,158,238', '0.37%', None, None]
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 消費金融_其他_擔保 | 247,086 | 83,835,636 | 0.29% |
| **消費金融_其他_無擔保** | **85,549** | **23,158,238** | **0.37%** |

✅ **PDF 有完整資料，解析器未能識別**

---

### 31 玉山商業銀行 (114Q1) - 有資料（但顯示為 `-`）

**資產品質頁：第 96 頁**

```
表格行 7: [None, '其 他\n（註 6）', '擔 保', '297,586', '438,278,026', '0.07', '4,454,838', '1,496.99']
表格行 8: [None, None, '無擔保', '-', '6,702,466', '-', '72,101', '-']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 消費金融_其他_擔保 | 297,586 | 438,278,026 | 0.07% |
| **消費金融_其他_無擔保** | **-** | **6,702,466** | **-** |

⚠️ **PDF 有此項目，但逾期放款金額顯示為 `-`**（表示該項目餘額為 0 或無逾期）

---

### 34 台新國際商業銀行 (114Q1) - 有資料

**資產品質頁：第 3 頁**

```
表格行 7: [None, '其 他\n（ 說 明 6 ）', '擔 保', '891,595', '397,507,221', '0.22%', '4,175,099', '468.27%']
表格行 8: [None, None, '無擔保', '2,169', '10,346,040', '0.02%', '106,086', '4,891.01%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 消費金融_其他_擔保 | 891,595 | 397,507,221 | 0.22% |
| **消費金融_其他_無擔保** | **2,169** | **10,346,040** | **0.02%** |

✅ **PDF 有完整資料，解析器未能識別**

---

### 10 中國輸出入銀行 (114Q1) - 無此業務

**資產品質頁：第 1 頁**

中國輸出入銀行為政策性銀行，**沒有消費金融業務**，PDF 中明確說明：

> 「本行目前並無辦理消費金融及信用卡業務」

🟢 **正常情況，應自動填入 0 或標記「無此業務」**

---

## 問題分析

### 解析器識別問題原因

`report_generator.py` 中對於「消費金融_其他_無擔保」的識別邏輯：

```python
elif "其他" in col1 or "其 他" in col1:
    if "擔保" in col2 or "擔 保" in col2:
        subject = "消費金融_其他_擔保"
    elif "無擔保" in col2 or "無 擔 保" in col2 or "無擔" in col2:
        subject = "消費金融_其他_無擔保"
```

問題在於：
1. 「其他」項目的「無擔保」通常在**下一行**，且第一欄（col0）和第二欄（col1）都是 `None`
2. 解析器期望在同一行找到「其他」和「無擔保」，但實際上是分兩行

### 表格結構示例

```
行7: [None, '其 他\n（註六）', '擔 保', ...]     ← 消費金融_其他_擔保
行8: [None, None, '無 擔 保', ...]               ← 消費金融_其他_無擔保（被遺漏）
```

---

## 解析器修復建議

### 方案一：追蹤上下文

```python
def extract_from_table(table, year, quarter, bank_name):
    results = []
    current_category = ""
    current_subcategory = ""  # 新增：追蹤子類別
    
    for row in table:
        # ... 正規化欄位 ...
        
        # 檢查「其他」子類別
        if "其他" in col1_normalized:
            current_subcategory = "其他"
            if "擔保" in col2_normalized and "無" not in col2_normalized:
                subject = "消費金融_其他_擔保"
            elif "無擔保" in col2_normalized:
                subject = "消費金融_其他_無擔保"
        
        # 如果當前是「其他」子類別的續行（col1 為空）
        elif current_subcategory == "其他" and col1_normalized == "":
            if "無擔保" in col2_normalized:
                subject = "消費金融_其他_無擔保"
            elif "擔保" in col2_normalized and "無" not in col2_normalized:
                subject = "消費金融_其他_擔保"
```

### 方案二：檢查 col2 直接判斷

```python
# 當 col0 和 col1 都是空的，但 col2 有「無擔保」
if (not col0_normalized and not col1_normalized and 
    "無擔保" in col2_normalized and current_category == "消費金融"):
    subject = "消費金融_其他_無擔保"
```

---

## 預期修復效果

| 銀行 | 修復前 | 修復後 |
|------|--------|--------|
| 台北富邦銀行 | 缺少此類別 | ✅ 69,463 / 39,476,849 / 0.18% |
| 王道商業銀行 | 缺少此類別 | ✅ 65,030 / 19,003,994 / 0.34% |
| 聯邦商業銀行 | 缺少此類別 | ✅ 85,549 / 23,158,238 / 0.37% |
| 玉山商業銀行 | 缺少此類別 | ✅ 0 / 6,702,466 / 0% |
| 台新國際商業銀行 | 缺少此類別 | ✅ 2,169 / 10,346,040 / 0.02% |
| 中國輸出入銀行 | 缺少此類別 | ✅ 0 / 0 / 0%（無此業務） |

---

## 結論

1. **5 家銀行**的「消費金融_其他_無擔保」資料缺失是**解析器識別問題**
2. 主要原因是「其他」類別的「擔保」和「無擔保」分為兩行，解析器未能正確處理續行
3. **1 家銀行**（中國輸出入銀行）確實無消費金融業務
4. 建議修改解析器，加入上下文追蹤功能，正確處理跨行的子類別資料
