# 企業金融類別資料調查報告

> 調查日期：2025-11-29  
> 調查目標：確認缺少「企業金融_擔保」、「企業金融_無擔保」類別的銀行 PDF 原始資料狀況

---

## 調查結論摘要

| 類型 | 銀行數量 | 說明 |
|------|----------|------|
| 🔴 **解析器識別問題** | 6 家 | PDF 中有完整資料，但解析器因格式差異未能識別 |
| 🟢 **無此業務（正常）** | 1 家 | 政策性銀行，確實無消費金融業務 |

---

## 第一類：解析器識別問題（6 家）

這些銀行的 PDF 表格中**有完整的企業金融資料**，但解析器未能正確識別。

### 問題原因

表格中的「企業金融」文字格式為：
- `企 業\n金 融`（有空格和換行）
- `企 業 金 融`（字間有空格）

而解析器搜尋的關鍵字是 `企業金融`（無空格），導致匹配失敗。

### 影響銀行列表

| 代碼 | 銀行名稱 | 季度 | 頁碼 | 表格格式 |
|------|----------|------|------|----------|
| 06 | 彰化商業銀行 | 114Q1 | 第 3 頁 | `企 業\n金 融` |
| 08 | 台北富邦銀行 | 114Q1 | 第 7 頁 | `企 業\n金 融` |
| 15 | 王道商業銀行 | 114Q1 | 第 5 頁 | `企 業\n金 融` |
| 27 | 聯邦商業銀行 | 114Q1 | 第 11 頁 | `企 業\n金 融` |
| 31 | 玉山商業銀行 | 114Q1 | 第 96 頁 | `企 業\n金 融` |
| 34 | 台新國際商業銀行 | 114Q1 | 第 3 頁 | `企 業 金 融` |

---

### 各銀行原始表格資料

#### 06 彰化商業銀行 (114Q1)

**資產品質頁：第 3 頁**

```
表格行 2: ['企 業\n金 融', '擔 保', None, '1,946,306', '668,415,169', '0.29%', '8,907,347', '457.65%']
表格行 3: [None, '無 擔 保', None, '198,965', '626,433,474', '0.03%', '8,175,097', '4108.81%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 1,946,306 | 668,415,169 | 0.29% |
| 企業金融_無擔保 | 198,965 | 626,433,474 | 0.03% |

---

#### 08 台北富邦銀行 (114Q1)

**資產品質頁：第 7 頁**

```
表格行 2: ['企 業\n金 融', '擔 保', None, '942,430', '327,769,727', '0.29%', '4,564,551', '484.34%']
表格行 3: [None, '無 擔 保', None, '410,027', '594,835,227', '0.07%', '7,643,987', '1,864.26%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 942,430 | 327,769,727 | 0.29% |
| 企業金融_無擔保 | 410,027 | 594,835,227 | 0.07% |

---

#### 15 王道商業銀行 (114Q1)

**資產品質頁：第 5 頁**

```
表格行 2: ['企 業\n金 融', '擔 保', None, '$ 1,254,353', '$ 110,902,817', '1.13%', '$ 1,314,979', '104.83%']
表格行 3: [None, '無 擔 保', None, '94,837', '81,151,881', '0.12%', '995,395', '1,049.59%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 1,254,353 | 110,902,817 | 1.13% |
| 企業金融_無擔保 | 94,837 | 81,151,881 | 0.12% |

---

#### 27 聯邦商業銀行 (114Q1)

**資產品質頁：第 11 頁**

```
表格行 2: ['企 業\n金 融', '擔 保', None, '$ 437,207', '$201,407,917', '0.22%', '$ 2,763,471', '525.82%']
表格行 3: [None, '無 擔 保', None, '88,347', '44,092,810', '0.20%', None, None]
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 437,207 | 201,407,917 | 0.22% |
| 企業金融_無擔保 | 88,347 | 44,092,810 | 0.20% |

---

#### 31 玉山商業銀行 (114Q1)

**資產品質頁：第 96 頁**

```
表格行 2: ['企 業\n金 融', '擔 保', None, '$ 937,884', '$ 497,079,604', '0.19', '$ 5,542,368', '590.94']
表格行 3: [None, '無 擔 保', None, '286,702', '634,666,878', '0.05', '6,805,639', '2,373.77']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 937,884 | 497,079,604 | 0.19% |
| 企業金融_無擔保 | 286,702 | 634,666,878 | 0.05% |

---

#### 34 台新國際商業銀行 (114Q1)

**資產品質頁：第 3 頁**

```
表格行 2: ['企 業 金 融', '擔 保', None, '465,819', '360,059,215', '0.13%', '3,863,402', '829.38%']
表格行 3: [None, '無 擔 保', None, '208,769', '484,187,942', '0.04%', '7,016,670', '3,360.97%']
```

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 465,819 | 360,059,215 | 0.13% |
| 企業金融_無擔保 | 208,769 | 484,187,942 | 0.04% |

---

## 第二類：無此業務（1 家）

### 10 中國輸出入銀行 (114Q1)

**資產品質頁：第 1 頁**

中國輸出入銀行是**政策性銀行**，專責辦理輸出入融資業務，**確實沒有消費金融業務**。

PDF 中明確說明：
> 「本行目前並無辦理消費金融及信用卡業務」

因此該銀行只有以下業務類別：

| 業務類別 | 逾期放款金額 | 放款總額 | 逾放比率 |
|----------|-------------|----------|----------|
| 企業金融_擔保 | 0 | 63,623,661 | 0.000% |
| 企業金融_無擔保 | 156,422 | 157,564,430 | 0.099% |
| 放款業務合計 | 156,422 | 221,188,091 | 0.071% |

**結論：此為正常情況，解析器應自動將消費金融相關類別填入 0 或標記「無此業務」。**

---

## 解析器修復建議

### 問題根因

`report_generator.py` 中的 `extract_from_table()` 函數使用以下關鍵字匹配：

```python
if "企業" in col0 and "金融" in col0:
    current_category = "企業金融"
```

但表格中的文字格式可能是：
- `企 業\n金 融`
- `企 業 金 融`
- `企業\n金融`

### 建議修復方案

```python
def normalize_text(text):
    """移除空格和換行，統一文字格式"""
    if text is None:
        return ""
    return str(text).replace(" ", "").replace("\n", "").replace("　", "").strip()

def extract_from_table(table, year, quarter, bank_name):
    # ...
    for row in table:
        # 正規化欄位文字
        col0_normalized = normalize_text(row[0]) if len(row) > 0 else ""
        col1_normalized = normalize_text(row[1]) if len(row) > 1 else ""
        col2_normalized = normalize_text(row[2]) if len(row) > 2 else ""
        
        # 使用正規化後的文字進行判斷
        if "企業金融" in col0_normalized:
            current_category = "企業金融"
            if "擔保" in col1_normalized and "無" not in col1_normalized:
                subject = "企業金融_擔保"
            elif "無擔保" in col1_normalized:
                subject = "企業金融_無擔保"
```

### 預期效果

修復後，所有 6 家銀行都應能正確識別企業金融類別：

| 銀行 | 修復前 | 修復後 |
|------|--------|--------|
| 彰化商業銀行 | 6/8 類別 | 8/8 類別 ✅ |
| 台北富邦銀行 | 4/8 類別 | 8/8 類別 ✅ |
| 王道商業銀行 | 4/8 類別 | 8/8 類別 ✅ |
| 聯邦商業銀行 | 5/8 類別 | 8/8 類別 ✅ |
| 玉山商業銀行 | 4/8 類別 | 8/8 類別 ✅ |
| 台新國際商業銀行 | 4/8 類別 | 8/8 類別 ✅ |

---

## 結論

1. **6 家銀行**的企業金融資料缺失是**解析器識別問題**，PDF 中有完整資料
2. **1 家銀行**（中國輸出入銀行）確實無消費金融業務，為正常情況
3. 建議修改解析器，加入文字正規化功能，移除空格和換行後再進行關鍵字匹配
